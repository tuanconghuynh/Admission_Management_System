<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Danh s√°ch h·ªì s∆° | Admission_Management_System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link rel="icon" type="image/png" href="hutech.png" sizes="32x32">
  <link rel="apple-touch-icon" href="hutech.png">
  <meta name="theme-color" content="#2563eb">
  <link rel="stylesheet" href="style.css">
  <!-- Flatpickr datepicker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/vn.js"></script>
   <style>
    /* Hover nh·∫π logo */
    a:hover img { transform: scale(1.05); transition: transform 0.2s ease; }
  </style>
</head>
<body class="min-h-screen flex flex-col bg-gray-50">
  <!-- Header -->
  <header class="w-full bg-white/85 backdrop-blur-sm border-b border-slate-200">
    <div class="max-w-7xl mx-auto px-6 py-3
                flex flex-col gap-3
                sm:flex-row sm:items-center sm:justify-between">

      <!-- Logo + ti√™u ƒë·ªÅ -->
      <a href="/ams_home.html"
        class="flex items-center gap-3 hover:opacity-90 transition"
        title="V·ªÅ trang ch·ªß">
        <img src="hutech.png" class="h-10 w-10" alt="HUTECH" />
        <div>
          <h1 class="text-2xl sm:text-3xl font-extrabold text-blue-700 leading-tight">
            ADMISSION MANAGEMENT SYSTEM - AMS
          </h1>
          <p class="text-sm sm:text-base text-gray-600 font-medium tracking-wide">
            V-HT.PTƒêT - H·ªá Th·ªëng Qu·∫£n L√Ω H·ªì S∆° Nh·∫≠p H·ªçc (AMS)
          </p>
        </div>
      </a>

      <!-- API Base (b√™n ph·∫£i ti√™u ƒë·ªÅ) -->
      <div class="flex items-center gap-2 text-xs sm:text-sm text-gray-600">
        <label for="apiBase" class="whitespace-nowrap">API Base</label>
        <input id="apiBase"
              class="input w-52 sm:w-64"
              placeholder="" />
      </div>
    </div>
  </header>
  <!-- Main -->
  <main class="flex-1 flex">
    <!-- SIDEBAR -->
    <aside class="hidden md:flex md:flex-col w-64 bg-white/85 border-r border-slate-200 backdrop-blur-sm">

      <!-- Kh·ªëi user ·ªü tr√™n c√πng sidebar (helloName / helloRole) -->
      <div class="px-4 pt-4 pb-3 border-b border-slate-200 relative">
        <button id="userMenuBtn"
          class="w-full justify-between text-sm text-gray-700 bg-white hover:bg-slate-50 px-3 py-2 rounded-lg shadow border flex items-center gap-2"
          aria-haspopup="true" aria-expanded="false" aria-controls="userMenu">
          <span>
            <b id="helloName">‚Äî</b>
            <span class="text-gray-500">(<span id="helloRole">‚Äî</span>)</span>
          </span>
          <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor" class="text-gray-500" aria-hidden="true">
            <path fill-rule="evenodd"
              d="M5.23 7.21a.75.75 0 011.06.02L10 11.187l3.71-3.956a.75.75 0 011.08 1.04l-4.24 4.52a.75.75 0 01-1.08 0l-4.24-4.52a.75.75 0 01.02-1.06z"
              clip-rule="evenodd"/>
          </svg>
        </button>

        <!-- Dropdown user -->
        <div id="userMenu"
             class="menu absolute right-0 top-[calc(100%+4px)] w-48 md:w-56
            bg-white border rounded-lg shadow-md overflow-hidden z-20 text-xs"
             role="menu">
          <a href="/account" class="block px-4 py-2 hover:bg-gray-50" role="menuitem">
            üîé Th√¥ng tin t√†i kho·∫£n
          </a>
          <a href="/account" class="block px-4 py-2 hover:bg-gray-50" role="menuitem">
            üîê ƒê·ªïi m·∫≠t kh·∫©u
          </a>
          <button id="btnMenuLogout"
                  class="w-full text-left px-4 py-2 hover:bg-gray-50 text-red-600"
                  role="menuitem">
            ‚Ü©Ô∏è ƒêƒÉng xu·∫•t
          </button>
        </div>

        <!-- C√°c element c≈© cho script /me hi·ªán t·∫°i (·∫©n ƒëi) -->
        <div id="userBox" class="hidden">
          <span id="meText">
            ‚úåÔ∏è Xin ch√†o: <b id="meName"></b> (<span id="meRole"></span>)
          </span>
          <a id="loginLink" href="/login">ƒêƒÉng nh·∫≠p</a>
          <button id="btnLogout">LogOut</button>
        </div>
      </div>

      <!-- Menu ch√≠nh -->
      <nav class="py-4 text-sm flex-1">
        <div class="px-4 pb-3 text-xs font-semibold text-gray-500 uppercase">
          Menu ch√≠nh
        </div>
        <a href="/ams_home.html"        class="nav-item">üè† Trang ch·ªß</a>
        <a href="/compilation.html"     class="nav-item">üìù Nh·∫≠p h·ªì s∆° m·ªõi</a>
        <a href="/students_list.html"   class="nav-item nav-item-active">üìã Danh s√°ch h·ªì s∆°</a>
        <a href="/import_students.html" class="nav-item">‚¨áÔ∏è Import h·ªçc vi√™n</a>
        <a href="/journal.html"         class="nav-item" id="journalLink">üïì Nh·∫≠t k√Ω h·ªá th·ªëng</a>
        <a href="/checklist_admin.html" class="nav-item">üìë Qu·∫£n l√Ω danh m·ª•c h·ªì s∆°</a>
        <a href="/admin"                class="nav-item">üë§ Qu·∫£n l√Ω t√†i kho·∫£n</a>
      </nav>
    </aside>

    <!-- CONTENT -->
    <section class="flex-1 flex items-start justify-center">
      <div class="max-w-7xl mx-auto px-6 py-6 w-full" id="pageContent">

        <!-- TI√äU ƒê·ªÄ TRANG -->
        <section class="mb-4">
          <h2 class="text-2xl font-bold text-gray-800">
            Danh s√°ch h·ªì s∆°
          </h2>
          <p class="text-gray-600 mt-1 text-sm">
            Tra c·ª©u nhanh & thao t√°c in/xu·∫•t, g·ª≠i email x√°c nh·∫≠n cho h·ªçc vi√™n.
          </p>
        </section>

        <!-- TOOLBAR + EXCEL + K·∫æT QU·∫¢ (GI·ªÆ Y NGUY√äN N·ªòI DUNG C≈®) -->
        <!-- Toolbar -->
        <section class="card space-y-4">
          <!-- H√†ng 1: T√¨m ki·∫øm + L·ªçc ƒë·ª£t/kh√≥a -->
          <div class="grid grid-cols-1 xl:grid-cols-3 gap-3 items-end">
            <div class="xl:col-span-2">
              <div class="flex items-center gap-2">
                <div class="relative flex-1 min-w-[240px]">
                  <input id="q" class="input w-full pl-10"
                         placeholder="Nh·∫≠p h·ªç v√† t√™n ho·∫∑c MSHV..."
                         aria-label="T·ª´ kh√≥a" />
                  <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" aria-hidden="true">üîé</span>
                </div>
                <div class="grid grid-cols-2 gap-2">
                  <select id="filterKhoa" class="input" title="L·ªçc theo Kh√≥a">
                    <option value="">T·∫•t c·∫£ kh√≥a</option>
                  </select>
                  <select id="filterDot" class="input" title="L·ªçc theo ƒê·ª£t">
                    <option value="">T·∫•t c·∫£ ƒë·ª£t</option>
                  </select>
                </div>
                <button id="btnSearch" class="btn btn-outline shrink-0" aria-label="T√¨m">üîé T√¨m</button>
              </div>
            </div>
          </div>

          <!-- Ti√™u ƒë·ªÅ + n√∫t Excel -->
          <div class="flex items-center justify-between">
            <h2 class="font-bold">IN / XU·∫§T D·ªÆ LI·ªÜU</h2>
            <button id="btnExcelToggle" class="btn btn-outline btn-xs" aria-expanded="false">
              ‚öôÔ∏è C·∫≠p nh·∫≠t t·ª´ Excel
            </button>
          </div>

          <!-- Bulk actions -->
          <div class="flex items-center justify-between mb-2">
            <div class="text-sm text-gray-600">
              ƒê√£ ch·ªçn: <span id="bulkCount" class="font-semibold">0</span> h·ªçc vi√™n
            </div>
            <div class="flex items-center gap-2">
              <button id="btnSendBulk" class="btn btn-primary disabled:opacity-50 disabled:pointer-events-none" disabled>
                ‚úâÔ∏è G·ª≠i email h√†ng lo·∫°t
              </button>
            </div>
          </div>

          <!-- D·∫£i t√°c v·ª• ƒë·∫πp h∆°n -->
          <div class="grid gap-3 md:grid-cols-2">
            <!-- Theo NG√ÄY -->
            <div class="rounded-2xl border bg-white/70 p-3 shadow-sm">
              <div class="text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide">Theo ng√†y</div>
              <div class="flex flex-wrap items-end gap-2">
                <input id="day" type="text" class="input w-60" placeholder="Ch·ªçn ng√†y..." />
                <div class="ml-auto flex items-center gap-2">
                  <button id="btnPrintDay"  class="btn btn-outline">üñ®Ô∏è In</button>
                  <button id="btnExportDay" class="btn btn-outline">‚¨áÔ∏è Xu·∫•t Excel</button>
                </div>
              </div>
            </div>
            <!-- Theo ƒê·ª¢T / KH√ìA -->
            <div class="rounded-2xl border bg-white/70 p-3 shadow-sm">
              <div class="text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide">Theo ƒë·ª£t / kh√≥a</div>
              <div class="flex flex-wrap items-end gap-2">
                <select id="dotKhoa" class="input w-40">
                  <option value="">-- Ch·ªçn kh√≥a --</option>
                </select>
                <select id="dot" class="input w-40">
                  <option value="">-- Ch·ªçn ƒë·ª£t --</option>
                </select>
                <div class="ml-auto flex items-center gap-2">
                  <button id="btnPrintDot"  class="btn btn-outline">üñ®Ô∏è In</button>
                  <button id="btnExportDot" class="btn btn-outline">‚¨áÔ∏è Xu·∫•t Excel</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Kh·ªëi Excel -->
          <div id="excelBox" class="hidden mt-5 border-t pt-4">
            <h3 class="font-semibold mb-2">TOOL EDIT INFO ‚Ä¢ Excel</h3>
            <div class="flex flex-wrap items-center gap-2 mt-2">
              <input id="batchFile" type="file" accept=".xlsx" class="input w-72" />
              <button id="btnDownloadTemplate" class="btn btn-outline">‚¨áÔ∏è T·∫£i m·∫´u .xlsx</button>
              <button id="btnBatchPreview" class="btn btn-outline">üëÄPreview</button>
              <button id="btnBatchApply" class="btn btn-primary">üíæ √Åp d·ª•ng</button>
              <label class="ml-3 inline-flex items-center gap-2 text-sm">
                <input id="stopOnError" type="checkbox" class="accent-blue-600" />
                D·ª´ng khi g·∫∑p l·ªói
              </label>
            </div>

            <div id="batchMsg" class="mt-2 text-sm text-gray-600"></div>

            <div id="batchPreviewWrap" class="hidden mt-2 overflow-auto border rounded-xl">
              <table class="table min-w-full">
                <thead>
                  <tr>
                    <th class="text-left">MSHV</th>
                    <th class="text-left">Tr·∫°ng th√°i</th>
                    <th class="text-left">Tr∆∞·ªùng thay ƒë·ªïi</th>
                  </tr>
                </thead>
                <tbody id="batchPreviewBody"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- Results -->
        <section class="card space-y-3 mt-6">
          <div class="flex items-center justify-between flex-wrap gap-2">
            <div class="text-sm text-gray-600">
              K·∫øt qu·∫£: <span id="count" class="badge">0</span>
            </div>
            <div id="msg" class="text-sm text-gray-600" role="status" aria-live="polite"></div>
          </div>

          <!-- Pagination toolbar (top) -->
          <div class="flex items-center justify-between gap-3">
            <div class="flex items-center gap-2 text-sm">
              <span>Hi·ªÉn th·ªã</span>
              <select id="pageSize" class="input w-24">
                <option selected>10</option><option>20</option><option>50</option><option>100</option>
              </select>
              <span>d√≤ng/trang</span>
            </div>
            <div class="flex items-center gap-1 text-sm pager" data-position="top">
              <button class="btn btn-outline btn-xs pager-first"  title="Trang ƒë·∫ßu">‚èÆÔ∏è</button>
              <button class="btn btn-outline btn-xs pager-prev"   title="Trang tr∆∞·ªõc">‚è™</button>
              <span class="mx-2 min-w-[160px] text-center pager-info">Trang 1/1 ‚Ä¢ 0 m·ª•c</span>
              <button class="btn btn-outline btn-xs pager-next"   title="Trang sau">‚è©</button>
              <button class="btn btn-outline btn-xs pager-last"   title="Trang cu·ªëi">‚è≠Ô∏è</button>
            </div>
          </div>

          <div class="overflow-hidden border rounded-xl">
            <div id="emptyState" class="p-10 text-center text-gray-500 hidden">
              <div class="text-4xl mb-2">‚ùåüßæ</div>
              <div class="font-semibold">Kh√¥ng t√¨m th·∫•y trong danh s√°ch</div>
              <div class="text-sm">Nh·∫≠p t·ª´ kh√≥a kh√°c ƒë·ªÉ t√¨m ki·∫øm!</div>
            </div>

            <div id="tableWrap" class="overflow-auto hidden">
              <table class="table min-w-full">
                <thead>
                  <tr>
                    <th class="text-center">
                      <input id="chkAll" type="checkbox" class="accent-blue-600" title="Ch·ªçn t·∫•t c·∫£ tr√™n trang" />
                    </th>
                    <th class="text-left">M√£ HS</th>
                    <th class="text-left th-sortable" data-sort="ho_dem" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo H·ªç ƒë·ªám">
                      H·ªç ƒë·ªám <span class="arrow"></span>
                    </th>
                    <th class="text-left th-sortable" data-sort="ten" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo T√™n">
                      T√™n <span class="arrow"></span>
                    </th>
                    <th class="text-left th-sortable" data-sort="ma_so_hv" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo MSHV">
                      MSHV <span class="arrow"></span>
                    </th>
                    <th class="th-sortable" data-sort="ngay_nhan_hs" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo Ng√†y nh·∫≠n">
                      Ng√†y nh·∫≠n <span class="arrow"></span>
                    </th>
                    <th class="th-sortable" data-sort="nganh" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo Ng√†nh">
                      Ng√†nh <span class="arrow"></span>
                    </th>
                    <th class="th-sortable" data-sort="dot" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo ƒê·ª£t">
                      ƒê·ª£t <span class="arrow"></span>
                    </th>
                    <th class="th-sortable" data-sort="khoa" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo Kh√≥a">
                      Kh√≥a <span class="arrow"></span>
                    </th>
                    <th class="th-sortable" data-sort="nguoi_nhan" role="button" tabindex="0" aria-label="S·∫Øp x·∫øp theo Ng∆∞·ªùi nh·∫≠n">
                      Ng∆∞·ªùi nh·∫≠n <span class="arrow"></span>
                    </th>
                    <th class="text-center">Email</th>
                    <th class="text-center">In</th>
                    <th class="text-center">S·ª≠a/X√≥a</th>
                  </tr>
                </thead>
                <tbody id="tbody"></tbody>
              </table>
            </div>

            <div id="loading" class="p-8 text-center text-gray-500 hidden">
              <span class="inline-block w-5 h-5 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin align-[-2px]" aria-hidden="true"></span>
              <span class="ml-2">ƒêang t·∫£i‚Ä¶</span>
            </div>
          </div>

          <!-- Pagination toolbar (bottom) -->
          <div class="flex items-center gap-1 text-sm pager" data-position="bottom">
            <button class="btn btn-outline btn-xs pager-first" title="Trang ƒë·∫ßu">‚èÆÔ∏è</button>
            <button class="btn btn-outline btn-xs pager-prev"  title="Trang tr∆∞·ªõc">‚è™</button>
            <span class="mx-2 min-w-[160px] text-center pager-info">Trang 1/1 ‚Ä¢ 0 m·ª•c</span>
            <button class="btn btn-outline btn-xs pager-next"  title="Trang sau">‚è©</button>
            <button class="btn btn-outline btn-xs pager-last"  title="Trang cu·ªëi">‚è≠Ô∏è</button>
          </div>
        </section>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-[#1E50B4] text-white mt-auto">
    <div class="max-w-7xl mx-auto px-6 py-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-6 text-sm">
      <div>
        <p class="font-semibold uppercase">VI·ªÜN H·ª¢P T√ÅC V√Ä PH√ÅT TRI·ªÇN ƒê√ÄO T·∫†O</p>
        <p class="uppercase">TR∆Ø·ªúNG ƒê·∫†I H·ªåC C√îNG NGH·ªÜ TPHCM (HUTECH)</p>
        <p><b>S√†i G√≤n Campus:</b> 475A ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng Th·∫°nh M·ªπ T√¢y, TP. H·ªì Ch√≠ Minh</p>
        <p><b>ƒêT:</b> (028) 6686 6465 ¬∑ 
          <b>Email:</b> <a href="mailto:daotaotructuyen@hutech.edu.vn" class="underline hover:text-yellow-300">daotaotructuyen@hutech.edu.vn</a>
        </p>
      </div>
      <p class="text-xs">¬© V-HT.PTƒêT HUTECH ‚Äî Code by HC-Tu·∫•n</p>
    </div>
  </footer>

  <!-- Toast wrap (n·∫øu anh c·∫ßn x√†i ki·ªÉu kh√°c) -->
  <div id="toast-wrap" class="fixed top-4 right-4 z-[9999] space-y-2 pointer-events-none"></div>

  <!-- Modal nh·∫≠p l√Ω do xo√° -->
  <div id="delModal" class="overlay" aria-modal="true" role="dialog">
    <div class="modal">
      <div class="hd">X√≥a h·ªì s∆°</div>
      <div class="bd">
        <p id="delMsg" class="mb-2 text-sm text-gray-700"></p>
        <label class="text-sm text-gray-800 font-semibold block mb-1">L√Ω do xo√° (b·∫Øt bu·ªôc)</label>
        <textarea id="delReason" placeholder="Nh·∫≠p l√Ω do‚Ä¶"></textarea>
        <p id="delErr" class="mt-1 text-xs text-rose-600 hidden">Vui l√≤ng nh·∫≠p l√Ω do!</p>
      </div>
      <div class="ft">
        <button id="delCancel" class="btn btn-outline">H·ªßy</button>
        <button id="delOk" class="btn btn-primary">OK</button>
      </div>
    </div>
  </div>

  <!-- Modal g·ª≠i email (Preview + Template) -->
  <div id="emailModal" class="fixed inset-0 z-[9999] hidden items-center justify-center bg-black/40">
    <div class="w-[920px] max-w-[95vw] rounded-2xl bg-white shadow-xl">
      <!-- Header -->
      <div class="flex items-center justify-between p-4 border-b">
        <h3 class="text-lg font-semibold">G·ª≠i email x√°c nh·∫≠n</h3>
        <button class="p-2 rounded-md hover:bg-gray-100" onclick="closeEmailModal()">‚úï</button>
      </div>
      <!-- Body -->
      <div class="p-4 space-y-4">
        <div class="grid grid-cols-12 gap-3">
          <div class="col-span-8">
            <label class="text-sm text-gray-600">ƒê·∫øn</label>
            <input id="email_to" class="input" disabled />
          </div>
          <div class="col-span-4">
            <label class="text-sm text-gray-600">MSHV</label>
            <input id="email_mshv" class="input" disabled />
          </div>
          <div class="col-span-8">
            <label class="text-sm text-gray-600">Ti√™u ƒë·ªÅ</label>
            <input id="email_subject" class="input" />
          </div>
          <div class="col-span-4">
            <label class="text-sm text-gray-600">Template</label>
            <select id="email_tpl" class="input">
              <option value="confirmation" selected>Bi√™n nh·∫≠n h·ªì s∆° (HS)</option>
              <option value="student_card">Th∆∞ th·∫ª SV</option>
            </select>
          </div>
        </div>

        <!-- Preview only -->
        <div class="mt-1 h-[45vh]">
          <textarea id="email_body" hidden></textarea>
          <iframe id="email_preview" class="w-full h-full rounded-lg border bg-white"></iframe>
        </div>

        <!-- Attach options -->
        <div class="flex items-center gap-4 text-sm">
          <label class="inline-flex items-center gap-2">
            <input id="chk_attach" type="checkbox" class="accent-blue-600" checked>
            <input id="chk_a5" type="checkbox" checked hidden>
            ƒê√≠nh k√®m bi√™n nh·∫≠n PDF
          </label>
          <a id="view_attach" href="#" target="_blank" class="text-blue-600 hover:underline hidden">
            Xem file ƒë√≠nh k√®m
          </a>
        </div>
      </div>

      <!-- Footer -->
      <div class="flex justify-end gap-3 p-4 border-t">
        <button class="btn btn-outline" onclick="closeEmailModal()">ƒê√≥ng</button>
        <button class="btn btn-primary" onclick="sendEmail()">G·ª≠i</button>
      </div>
    </div>
  </div>

  <!-- Modal preview g·ª≠i h√†ng lo·∫°t -->
  <div id="bulkEmailModal" class="fixed inset-0 z-[10000] hidden items-center justify-center bg-black/40">
    <div class="w-[960px] max-w-[95vw] rounded-2xl bg-white shadow-xl">
      <div class="flex items-center justify-between p-4 border-b">
        <h3 class="text-lg font-semibold">G·ª≠i email h√†ng lo·∫°t</h3>
        <button class="p-2 rounded-md hover:bg-gray-100" onclick="closeBulkModal()">‚úï</button>
      </div>

      <div class="p-4 space-y-4">
        <div class="text-sm text-gray-700">
          S·ªë l∆∞·ª£ng h·ªçc vi√™n s·∫Ω g·ª≠i: <b id="bulkCountLabel">0</b>
        </div>
        <div class="max-h-24 overflow-auto rounded border p-2 bg-gray-50 text-sm">
          <div id="bulkListLabel" class="font-mono whitespace-pre-wrap"></div>
        </div>
        <!-- Ch·ªçn h·ªçc vi√™n ƒë·ªÉ xem m·∫´u -->
        <div>
          <label class="text-sm text-gray-600 block mb-1">Xem m·∫´u c·ªßa h·ªçc vi√™n</label>
          <select id="bulkPreviewSelect" class="input w-full"></select>
        </div>

        <div>
          <label class="text-sm text-gray-600 block mb-1">Ti√™u ƒë·ªÅ</label>
          <input id="bulk_subject" class="input" />
        </div>

        <div class="h-[45vh]">
          <iframe id="bulk_preview" class="w-full h-full rounded-lg border bg-white"></iframe>
        </div>
        <p class="text-xs text-gray-500">
          (Preview d√πng m·∫´u A5 c·ªßa h·ªçc vi√™n ƒë·∫ßu ti√™n trong danh s√°ch ƒë·ªÉ ki·ªÉm tra n·ªôi dung/logo.
          Khi g·ª≠i s·∫Ω d√πng n·ªôi dung t∆∞∆°ng ·ª©ng cho t·ª´ng h·ªçc vi√™n.)
        </p>
      </div>

      <div class="flex justify-end gap-3 p-4 border-t">
        <button class="btn btn-outline" onclick="closeBulkModal()">ƒê√≥ng</button>
        <button class="btn btn-primary" id="bulkSendBtn">G·ª≠i</button>
      </div>
    </div>
  </div>

  <!-- Modal logout (gi·ªëng import) -->
  <div class="overlay" id="logoutModal" role="dialog" aria-modal="true" aria-labelledby="lgTitle">
    <div class="modal" role="document" aria-describedby="lgDesc" tabindex="-1" id="logoutBox">
      <div class="px-6 py-4 border-b flex items-center justify-between">
        <div id="lgTitle" class="font-semibold text-gray-800">X√°c nh·∫≠n</div>
        <button class="btn btn-outline btn-xs" id="lgClose" aria-label="ƒê√≥ng">‚úï</button>
      </div>
      <div class="px-6 py-5" id="lgDesc">
        <p class="text-gray-700">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?</p>
      </div>
      <div class="px-6 py-4 border-t flex justify-end gap-2 bg-gray-50 rounded-b-2xl">
        <button class="btn btn-outline" id="lgCancel">H·ªßy</button>
        <button class="btn btn-primary" id="lgOK">ƒêƒÉng xu·∫•t</button>
      </div>
    </div>
  </div>

  <!-- Drawer xem chi ti·∫øt h·ªì s∆° -->
<div id="detailDrawer" class="fixed inset-0 z-[9500] hidden">
  <!-- N·ªÅn m·ªù -->
  <div class="absolute inset-0 bg-black/40" id="detailBackdrop"></div>

  <!-- Panel ph·∫£i -->
  <div class="absolute right-0 top-0 h-full w-full sm:w-[520px] bg-white shadow-2xl flex flex-col">
    <!-- Header -->
    <div class="px-5 py-4 border-b flex items-start justify-between gap-3">
      <div>
        <div class="text-xs uppercase text-gray-400 tracking-wide">H·ªí S∆† H·ªåC VI√äN</div>
        <h3 id="detailName" class="text-lg font-semibold text-gray-900">
          ƒêang t·∫£i‚Ä¶
        </h3>
        <p class="text-sm text-gray-600 mt-1">
          MSHV: <span id="detailMSHV" class="font-mono text-gray-800">‚Äî</span>
          ‚Ä¢ M√£ HS: <span id="detailMaHS" class="font-mono text-gray-800">‚Äî</span>
        </p>
      </div>
      <div class="flex flex-col items-end gap-2">
        <span id="detailStatusBadge"
              class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-slate-100 text-slate-700">
          ƒêang t·∫£i‚Ä¶
        </span>
        <button id="detailCloseBtn"
                class="inline-flex items-center justify-center w-8 h-8 rounded-full hover:bg-gray-100 text-gray-500"
                aria-label="ƒê√≥ng">
          ‚úï
        </button>
      </div>
    </div>

    <!-- N·ªôi dung -->
    <div class="flex-1 overflow-auto px-5 py-4 space-y-4 text-sm">
      <!-- Th√¥ng tin chung -->
      <section class="border rounded-xl p-3 bg-gray-50/60">
        <div class="flex items-center justify-between mb-2">
          <h4 class="font-semibold text-gray-800">Th√¥ng tin chung</h4>
          <span id="detailGenderBadge"
                class="inline-flex px-2 py-0.5 rounded-full text-[11px] bg-blue-50 text-blue-700 border border-blue-100">
            ‚Äî
          </span>
        </div>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1">
          <div><span class="text-gray-500">H·ªç ƒë·ªám:</span> <span id="detailHoDem" class="font-medium">‚Äî</span></div>
          <div><span class="text-gray-500">T√™n:</span> <span id="detailTen" class="font-medium">‚Äî</span></div>
          <div><span class="text-gray-500">Ng√†y sinh:</span> <span id="detailNgaySinh">‚Äî</span></div>
          <div><span class="text-gray-500">Gi·ªõi t√≠nh:</span> <span id="detailGioiTinh">‚Äî</span></div>
          <div><span class="text-gray-500">D√¢n t·ªôc:</span> <span id="detailDanToc">‚Äî</span></div>
        </div>
      </section>

      <!-- Li√™n h·ªá -->
      <section class="border rounded-xl p-3">
        <h4 class="font-semibold text-gray-800 mb-2">Th√¥ng tin li√™n h·ªá</h4>
        <div class="space-y-1">
          <div><span class="text-gray-500">S·ªë ƒëi·ªán tho·∫°i:</span> <span id="detailSoDT" class="font-mono">‚Äî</span></div>
          <div><span class="text-gray-500">Email h·ªçc vi√™n:</span>
            <a id="detailEmail" href="#" class="text-blue-600 hover:underline break-all">‚Äî</a>
          </div>
        </div>
      </section>

      <!-- Th√¥ng tin nh·∫≠p h·ªçc -->
      <section class="border rounded-xl p-3 bg-gray-50/60">
        <h4 class="font-semibold text-gray-800 mb-2">Th√¥ng tin nh·∫≠p h·ªçc</h4>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1">
          <div><span class="text-gray-500">Ng√†nh:</span> <span id="detailNganh" class="font-medium">‚Äî</span></div>
          <div><span class="text-gray-500">Kh√≥a:</span> <span id="detailKhoa" class="font-medium">‚Äî</span></div>
          <div><span class="text-gray-500">ƒê·ª£t:</span> <span id="detailDot">‚Äî</span></div>
          <div><span class="text-gray-500">Ng√†y nh·∫≠n HS:</span> <span id="detailNgayNhan">‚Äî</span></div>
          <div class="col-span-2">
            <span class="text-gray-500">Ng∆∞·ªùi nh·∫≠n/ki·ªÉm:</span>
            <span id="detailNguoiNhan" class="font-medium">‚Äî</span>
          </div>
        </div>
      </section>

      <!-- T√¨nh tr·∫°ng h·ªì s∆° -->
      <section class="border rounded-xl p-3">
        <div class="flex items-center justify-between mb-1.5">
          <h4 class="font-semibold text-gray-800">T√¨nh tr·∫°ng h·ªì s∆°</h4>
          <span id="detailChecklistSummary" class="text-xs text-gray-500">‚Äî</span>
        </div>
        <ul id="detailChecklist" class="space-y-1 text-sm">
          <!-- s·∫Ω render t·ª´ BE -->
          <li class="text-gray-500 italic">ƒêang t·∫£i danh m·ª•c h·ªì s∆°‚Ä¶</li>
        </ul>
      </section>

      <!-- Ghi ch√∫ & nh·∫≠t k√Ω -->
      <section class="border rounded-xl p-3">
        <h4 class="font-semibold text-gray-800 mb-2">Ghi ch√∫</h4>
        <p id="detailGhiChu" class="text-sm text-gray-700 whitespace-pre-line">
          ‚Äî
        </p>
        <div class="mt-3 text-xs text-gray-500">
          <div>C·∫≠p nh·∫≠t l·∫ßn cu·ªëi: <span id="detailUpdatedAt">‚Äî</span></div>
          <div>Ng∆∞·ªùi c·∫≠p nh·∫≠t: <span id="detailUpdatedBy">‚Äî</span></div>
        </div>
      </section>
    </div>

    <!-- Footer action -->
    <div class="px-5 py-3 border-t bg-gray-50 flex items-center justify-between">
      <button id="detailOpenEditBtn"
              class="btn btn-outline btn-xs">
        ‚úèÔ∏è M·ªü trang S·ª≠a h·ªì s∆°
      </button>
      <div class="flex gap-2">
        <button id="detailPrintA5Btn" class="btn btn-soft btn-xs">üñ®Ô∏è In A5</button>
        <button id="detailPrintA4Btn" class="btn btn-primary btn-xs">üñ®Ô∏è In A4</button>
      </div>
    </div>
  </div>
</div>

<!-- GLOBAL LOADING OVERLAY -->
<div id="globalLoading"
     class="fixed inset-0 bg-black/40 backdrop-blur-sm hidden
            flex items-center justify-center z-[9999]">
  <div class="bg-white px-6 py-4 rounded-xl shadow-lg text-center animate-fade">
    <div class="loader mb-3"></div>
    <div class="font-semibold text-gray-700">ƒêang t·∫£i d·ªØ li·ªáu, vui l√≤ng ƒë·ª£i...</div>
  </div>
</div>

<script src="students_list.js"></script>
</body>
</html>
